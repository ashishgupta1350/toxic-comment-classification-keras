Operations on word vectors
Welcome to your first assignment of this week!

Because word embeddings are very computionally expensive to train, most ML practitioners will load a pre-trained set of embeddings.

After this assignment you will be able to:

Load pre-trained word vectors, and measure similarity using cosine similarity
Use word embeddings to solve word analogy problems such as Man is to Woman as King is to __.
Modify word embeddings to reduce their gender bias
Let's get started! Run the following cell to load the packages you will need.



======== Chapter 1 A Sunny Day in Londontown


Ryan was nearly killed twice in half an hour. He left the taxi a few blocks short of his destination. It was a fine, clear day, the sun already low in the blue sky. Ryan had been sitting for hours in a series of straight-back wooden chairs, and he wanted to walk a bit to work the kinks out. Traffic was relatively light on the streets and sidewalks. That surprised him, but he looked forward to the evening rush hour. Clearly these streets had not been laid out with automobiles in mind, and he was sure that the afternoon chaos would be something to behold. Jack's first impression of London was that it would be a fine town to walk in, and he moved at his usual brisk pace, unchanged since his stint in the Marine Corps, marking time unconsciously by tapping the edge of his clipboard against his leg.

Just short of the corner the traffic disappeared, and he moved to cross the street early. He automatically looked left, right, then left again as he had since childhood, and stepped off the curb --

And was nearly crushed by a two-story red bus that screeched past him with a bare two feet to spare.

"Excuse me, sir." Ryan turned to see a police officer -- they call them constables over here, he reminded himself -- in uniform complete to the Mack Sennett hat. "Please do be careful and cross at the corners. You might also mind the painted signs on the pavement to look right or left. We try not to lose too many tourists to the traffic." "How do you know I'm a tourist?" He would now, from Ryan's accent.

The cop smiled patiently. "Because you looked the wrong way, sir, and you dress like an American. Please be careful, sir. Good day." The bobby moved off with a friendly nod, leaving Ryan to wonder what there was about his brand-new three-piece suit that marked him as an American.

Chastened, he walked to the corner. Painted lettering on the blacktop warned him to LOOK RIGHT, along with an arrow for the dyslexic. He waited for the light to change, and was careful to stay within the painted lines. Jack remembered that he'd have to pay close attention to the traffic, especially when he rented the car Friday. England was one of the last places in the world where the people drove on the wrong side of the road. He was sure it would take some getting used to.

But they did everything else well enough, he thought comfortably, already drawing universal observations one day into his first trip to Britain. Ryan was a practiced observer, and one can draw many conclusions from a few glances. He was walking in a business and professional district. The other people on the sidewalk were better dressed than their American counterparts would be -- aside from the punkers with their spiked orange and purple hair, he thought. The architecture here was a hodgepodge ranging from Octavian Augustus to Mies van der Rohe, but most of the buildings had an old, comfortable look that in Washington or Baltimore would long since have been replaced with an unbroken row of new and soulless glass boxes. Both aspects of the town dovetailed nicely with the good manners he'd encountered so far. It was a working vacation for Ryan, but first impressions told him that it would be a very pleasant one nonetheless.

There were a few jarring notes. Many people seemed to be carrying umbrellas. Ryan had been careful to check the day's weather forecast before setting out on his research trip. A fair day had been accurately predicted -- in fact it had been called a hot day, though temperatures were only in the upper sixties. A warm day for this time of year, to be sure, but "hot"? Jack wondered if they called it Indian summer here. Probably not. Why the umbrellas, though? Didn't people trust the local weather service? Was that how the cop knew I was an American?

Another thing he ought to have anticipated was the plethora of Rolls-Royces on the streets. He hadn't seen more than a handful in his entire life, and while the streets were not exactly crowded with them, there were quite a few. He himself usually drove around in a five-year-old VW Rabbit. Ryan stopped at a newsstand to purchase a copy of The Economist, and had to fumble with the change from his cab fare for several seconds in order to pay the patient dealer, who doubtless also had him pegged for a Yank. He paged through the magazine instead of watching where he was going as he went down the street, and presently found himself halfway down the wrong block. Ryan stopped dead and thought back to the city map he'd inspected before leaving the hotel. One thing Jack could not do was remember street names, but he had a photographic memory for maps. He walked to the end of the block, turned left, proceeded two blocks, then right, and sure enough there was St. James's Park. Ryan checked his watch; he was fifteen minutes early. It was downhill past the monument to a Duke of York, and he crossed the street near a longish classical building of white marble.

Yet another pleasant thing about London was the profusion of green spaces. The park looked big enough, and he could see that the grass was tended with care. The whole autumn must have been unseasonably warm. The trees still bore plenty of leaves. Not many people around, though. Well, he shrugged, it's Wednesday. Middle of the week, the kids were all in school, and it was a normal business day. So much the better, he thought. He'd deliberately come over after the tourist season. Ryan did not like crowds. The Marine Corps had taught him that, too.

"Daddee!" Ryan's head snapped around to see his little daughter running toward him from behind a tree, heedless as usual of her safety. Sally arrived with her customary thump against her tall father. Also as usual, Cathy Ryan trailed behind, never quite able to keep up with their little white tornado. Jack's wife did look like a tourist. Her Canon 35mm camera was draped over one shoulder, along with the camera case that doubled as an oversized purse when they were on vacation.

"How'd it go. Jack?"

Ryan kissed his wife. Maybe the Brits don't do that in public either, he thought. "Great, babe. They treated me like I owned the place. Got all my notes tucked away." He tapped his clipboard. "Didn't you get anything?" Cathy laughed.

"The shops here deliver." She smiled in a way that told him she'd parted with a fairish bit of the money they had allocated for shopping. "And we got something really nice for Sally."

"Oh?" Jack bent over to look his daughter in the eye. "And what might that be?"

"It's a surprise. Daddy." The little girl twisted and giggled like a true four-year-old. She pointed to the park. "Daddy, they got a lake with swans and peccalins!"

"Pelicans," Jack corrected.

"Big white ones!" Sally loved peccalins.

"Uh-huh," Ryan observed. He looked up to his wife. "Get any good pictures?"

Cathy patted her camera. "Oh, sure. London is already Canonized -- or would you prefer that we spent the whole day shopping?" Photography was Cathy Ryan's only hobby, and she was good at it.

"Ha!" Ryan looked down the street. The pavement here was reddish, not black, and the road was lined with what looked like beech trees. The Mall, wasn't it? He couldn't remember, and would not ask his wife, who'd been to London many times. The Palace was larger than he'd expected, but it seemed a dour building, three hundred yards away, hidden behind a marble monument of some sort. Traffic was a little thicker here, but moved briskly. "What do we do for dinner?"

"Catch a cab back to the hotel?" She looked at her watch. "Or we can walk."

"They're supposed to have a good dining room. Still early, though. These civilized places make you wait until eight or nine." He saw another Rolls go by in the direction of the Palace. He was looking forward to dinner, though not really to having Sally there. Four-year-olds and four-star restaurants didn't go well together. Brakes squealed off to his left. He wondered if the hotel had a baby-sitting --

BOOM!

Ryan jumped at the sound of an explosion not thirty yards away. Grenade, something in his mind reported. He sensed the whispering sound of fragments in the air and a moment later heard the chatter of automatic weapons fire. He spun around to see the Rolls turned crooked in the street. The front end seemed lower than it should be, and its path was blocked by a black sedan. There was a man standing at its right front fender, firing an AK-47 rifle into the front end, and another man was racing around to the car's left rear.

"Get down!" Ryan grabbed his daughter's shoulder and forced her to the ground behind a tree, yanking his wife roughly down beside her. A dozen cars were stopped raggedly behind the Rolls, none closer than fifty feet, and these shielded his family from the line of fire. Traffic on the far side was blocked by the sedan. The man with the Kalashnikov was spraying the Rolls for all he was worth.

"Sonuvabitch!" Ryan kept his head up, scarcely able to believe what he saw. "It's the goddamned IRA -- they're killing somebody right --" Ryan moved slightly to his left. His peripheral vision took in the faces of people up and down the street, turning and staring, in each face the black circle of a shock-opened mouth. This is really happening! he thought, right in front of me, just like that, just like some Chicago gangster movie. Two bastards are committing murder. Right here. Right now. Just like that. "Son of a bitch!"

Ryan moved farther left, screened by a stopped car. Covered by its front fender, he could see one man standing at the left rear of the Rolls, just standing there, his pistol hand extended as though expecting someone to bolt from the passenger door. The bulk of the Rolls screened Ryan from the AK gunner, who was crouched down to control his weapon. The near gunman had his back to Ryan. He was no more than fifty feet away. He didn't move, concentrating on the passenger door. His back was still turned. Ryan would never remember making any conscious decision.

He moved quickly around the stopped car, head down, keeping low and accelerating rapidly, his eyes locked on his target -- the small of the man's back -- just as he'd been taught in high school football. It took only a few seconds to cover the distance, with Ryan's mind reaching out, willing the man to stay dumb just a moment longer. At five feet Ryan lowered his shoulder and drove off both legs. His coach would have been proud.

The blind-side tackle caught the gunman perfectly. His back bent like a bow and Ryan heard bones snap as his victim pitched forward and down. A satisfying klonk told him that the man's head had bounced off the bumper on the way to the pavement. Ryan got up instantly -- winded but full of adrenaline -- and crouched beside the body. The man's pistol had dropped from his hand and lay beside the body. Ryan grabbed it. It was an automatic of some sort he had never handled. It looked like a 9mm Makarov or some other East Bloc military issue. The hammer was back and the safety off. He fitted the gun carefully in his right hand -- his left hand didn't seem to be working right, but Ryan ignored that. He looked down at the man he'd just tackled and shot him once in the hip. Then he brought the gun up to eye level and moved to the right rear corner of the Rolls. He crouched lower still and peeked around the edge of the bodywork.

The other gunman's AK was lying on the street and he was firing into the car with his own pistol, something else in his other hand. Ryan took a deep breath and stepped from behind the Rolls, leveling his automatic at the man's chest. The other gunman turned his head first, then swiveled off-balance to bring his own gun around. Both men fired at the same instant. Ryan felt a fiery thump in his left shoulder and saw his own round take the man in the chest. The 9mm slug knocked the man backward as though from a hard punch. Ryan brought his own pistol down from recoil and squeezed off another round. The second bullet caught the man under the chin and exploded out the back of his head in a wet, pink cloud. Like a puppet with severed strings, the gunman fell to the pavement without a twitch. Ryan kept his pistol centered on the man's chest until he saw what had happened to his head.


